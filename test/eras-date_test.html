<!doctype html>
<html lang='en'>

<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes'>

  <title>eras-date test</title>

  <script src='../../webcomponentsjs/webcomponents-lite.js'></script>
  <script src='../../web-component-tester/browser.js'></script>

  <script src='../bower_components/iron-test-helpers/mock-interactions.js'></script>
  <script src='../bower_components/moment/moment.js'></script>
  <link rel='import' href='../eras-calendar-page.html'>
  <link rel='import' href='../eras-calendar.html'>
  <link rel='import' href='../eras-date.html'>
</head>

<body>
  <test-fixture id='date-fixture'>
    <template>
      <eras-date value='2017-04-18' min='1900-01-01' max='2020-12-31'></eras-date>
    </template>
  </test-fixture>

  <script>
    suite('eras-date', function () {
      var el;

      setup(function () {
        el = fixture('date-fixture');
        // el.min = '1900-01-01';
        // el.max = '2020-12-31';
        // el.value = '2017-04-18';
      });

      test('instantiation', function () {
        assert.equal(el.is, 'eras-date');
      });

      test('selection', function (done) {
        flush(function () {
          var target = '1986-02-28';
          el.$.display.$.year.click();
          el.$.years.$.list.items[34].click();
          el.$.calendar.$.previous.click();
          el.$.calendar.$.previous.click();

          flush(function () {
            var page = el.$.calendar.$.pages.querySelector('[index=\'' + el.$.calendar._page + '\']');
            var dates = page.$.dates.querySelectorAll('.cell:not(.blank)');
            dates[27].click();     
            assert.equal(target, el.value, 'expected ' + target + ' to have been selected.');      
            done();
          });
        });
      });
    });
  </script>
</body>

</html>